#! /bin/bash

box_path=$1
box_filename=$(basename "${box_path}")
box_name=lathe
box_provider=virtualbox
tmp_path=/tmp/lathe_test

rm -rf ${tmp_path}

vagrant box remove ${box_name} --provider ${box_provider} 2>/dev/null || true
vagrant box add ${box_name} ${box_path}

mkdir -p ${tmp_path}

pushd ${tmp_path}

cp ~/lathe/Vagrantfile ${tmp_path}/  # FIXME
VAGRANT_LOG=warn vagrant up --provider ${box_provider}
vagrant destroy -f

popd

vagrant box remove ${box_name} --provider ${box_provider}
